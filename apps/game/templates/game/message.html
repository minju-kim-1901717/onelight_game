<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë©”ì‹œì§€</title>
  <style>
    :root{
      --bg:#0b0b0f;
      --line:rgba(255,255,255,.08);
      --muted:rgba(255,255,255,.74);
      --pink:#c714c7;
      --pink2:#ff6ad5;
      --white:#ffffff;
    }

    /* âœ… ê°€ë¡œ ì‚ì ¸ë‚˜ê° ë°©ì§€ í•µì‹¬ */
    *{ box-sizing:border-box; }
    html, body{ width:100%; overflow-x:hidden; }

    body{
      font-family:system-ui;
      margin:0;
      padding:24px;
      background:
        radial-gradient(900px 420px at 50% -10%, rgba(199,20,199,.20), rgba(11,11,15,1) 60%),
        radial-gradient(800px 360px at 85% 10%, rgba(255,106,213,.10), rgba(11,11,15,0) 60%),
        var(--bg);
      color:#fff;
      height:100vh;
    }

    .wrap{max-width:560px;margin:0 auto;display:flex;flex-direction:column;gap:14px}

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:20px;
      padding:18px;
      box-shadow:0 22px 60px rgba(0,0,0,.58), 0 0 44px rgba(199,20,199,.10);
      position:relative;
      overflow:hidden;
    }
    .card:before{
      content:"";
      position:absolute;
      inset:-40%;
      background: radial-gradient(closest-side, rgba(199,20,199,.16), rgba(199,20,199,0) 70%);
      transform: translate(40%, -30%);
      filter: blur(18px);
      pointer-events:none;
    }

    .title{
      font-weight:1000;
      margin:0 0 6px 0;
      font-size:20px;
      letter-spacing:-.2px;
      background: linear-gradient(120deg, var(--pink), var(--pink2), var(--white), var(--pink2), var(--pink));
      background-size: 400% 400%;
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      animation: gradientMove 5.5s ease infinite;
      text-shadow:0 0 18px rgba(199,20,199,.35), 0 0 34px rgba(199,20,199,.18);
    }
    @keyframes gradientMove{
      0%{ background-position:0% 50%; }
      50%{ background-position:100% 50%; }
      100%{ background-position:0% 50%; }
    }

    .muted{opacity:.9;font-size:13px;line-height:1.45;color:var(--muted)}
    .pillWrap{margin-top:12px;display:flex;justify-content:center;gap:10px;flex-wrap:wrap;text-align:center}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      background:rgba(31,31,44,.9);
      border:1px solid rgba(255,255,255,.06);
      border-radius:999px;
      padding:10px 14px;
      font-weight:1000;
      box-shadow:0 10px 24px rgba(0,0,0,.25);
    }
    .pill strong{font-weight:1000;color:#fff}
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      margin-top:12px;padding:8px 12px;border-radius:999px;
      font-weight:1000;font-size:12px;letter-spacing:.2px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(199,20,199,.14);
      box-shadow: 0 0 22px rgba(199,20,199,.16);
    }
    .hidden{display:none}

    .btn{
      width:100%;
      padding:14px;
      border-radius:14px;
      border:0;
      font-weight:1000;
      cursor:pointer;
      transition: transform .14s ease, filter .18s ease, box-shadow .2s ease, opacity .2s ease;
    }
    .btn:active{ transform:scale(.99); }
    .btnPrimary{
      background:var(--pink);color:#fff;
      box-shadow: 0 14px 34px rgba(199,20,199,.24);
    }
    .btnPrimary:hover{ filter:brightness(1.06); box-shadow: 0 16px 38px rgba(199,20,199,.30); }
    .btnGhost{
      background:#2a2a3a;color:#fff;
      border:1px solid rgba(255,255,255,.08);
    }
    .btnGhost:hover{ filter:brightness(1.06); }
    .btn:disabled{opacity:.55;cursor:not-allowed;box-shadow:none}

    .row{display:flex;gap:10px}
    .row button{flex:1}

    /* composer */
    select, textarea{
      width:100%;
      max-width:100%;
      margin-top:12px;
      background: rgba(11,11,15,.95);
      color:#fff;
      border:1px solid rgba(255,255,255,.14);
      border-radius:16px;
      padding:12px 12px;
      font-size:15px;
      outline:none;
      transition: border-color .2s ease, box-shadow .2s ease, filter .2s ease;
      display:block;
    }
    select:focus, textarea:focus{
      border-color: rgba(199,20,199,.55);
      box-shadow:0 0 0 4px rgba(199,20,199,.14), 0 0 22px rgba(199,20,199,.12);
      filter: brightness(1.03);
    }
    textarea{min-height:110px; resize:none;}

    .counterRow{
      display:flex;justify-content:space-between;align-items:center;gap:10px;
      margin-top:10px;color:var(--muted);font-size:13px;
    }
    .miniPill{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 10px;border-radius:999px;
      background: rgba(31,31,44,.9);
      border:1px solid rgba(255,255,255,.06);
      font-weight:1000;
      white-space:nowrap;
    }
    .lockHint{
      margin-top:10px;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(16,16,26,.75);
      box-shadow: inset 0 0 0 1px rgba(199,20,199,.06);
    }

    /* fullscreen FX */
    .fx{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      padding:24px;
      background: rgba(0,0,0,.72);
      backdrop-filter: blur(6px);
      z-index:9999;
      overflow:hidden;
      opacity:0;
      transition: opacity .18s ease;
    }
    .fx.show{ display:flex; opacity:1; }

    .fxPanel{
      width:min(540px, 92vw);
      border-radius:22px;
      padding:20px 18px;
      text-align:center;
      border:1px solid rgba(255,255,255,.10);
      background: radial-gradient(900px 320px at 50% 0%, rgba(199,20,199,.22), rgba(20,20,32,.92) 60%);
      box-shadow:0 30px 90px rgba(0,0,0,.7), 0 0 70px rgba(199,20,199,.22);
      transform: translateY(14px) scale(.96);
      opacity:0;
      animation: fxIn .28s ease forwards;
      position:relative;
      overflow:hidden;
    }
    @keyframes fxIn{ to{ transform: translateY(0) scale(1); opacity:1; } }

    .fxTitle{
      font-weight:1000;
      font-size:26px;
      letter-spacing:-0.3px;
      margin:0;
      background: linear-gradient(120deg, var(--pink), var(--pink2), var(--white), var(--pink2), var(--pink));
      background-size: 420% 420%;
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      animation: gradientMove 4.5s ease infinite;
      text-shadow:0 0 22px rgba(199,20,199,.50), 0 0 40px rgba(199,20,199,.25);
    }
    .fxSub{ margin-top:8px; opacity:.82; font-weight:900; }
    .fxName{ margin-top:14px; font-weight:1000; font-size:18px; color:#fff; opacity:.95; }
    .fxBtn{
      margin-top:16px;
      width:100%;
      padding:14px;
      border-radius:14px;
      border:0;
      font-weight:1000;
      background:var(--pink);
      color:#fff;
      cursor:pointer;
      box-shadow: 0 12px 30px rgba(199,20,199,.25);
    }

    .confetti{
      position:absolute;
      top:-10px;
      width:10px;
      height:14px;
      opacity:.9;
      border-radius:3px;
      animation: fall 1.6s linear forwards;
      filter: drop-shadow(0 0 10px rgba(199,20,199,.18));
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(540deg); opacity:0.2; }
    }
  </style>
</head>

<body>
<div class="wrap">

  <div class="card">
    <div class="title">2ë¶€ MESSAGE âœ¨</div>
    <div id="desc" class="muted">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

    <div class="pillWrap">
      <div class="pill">ğŸ“© ë°›ì€ ë©”ì‹œì§€ <strong><span id="msgCount">0</span>ê°œ</strong></div>
      <div id="limitPill" class="pill hidden">âœ‰ï¸ ë‚´ ì „ì†¡ <strong><span id="sentMsg">0</span>/1</strong></div>
      <div id="timerPill" class="pill hidden">â±ï¸ ë‚¨ì€ ì‹œê°„ <strong><span id="remain">--:--</span></strong></div>
    </div>

    <div id="badge" class="badge hidden" style="margin-bottom: 10px;">ğŸ’ 2ë¶€ ì „ìš© ê¸°ëŠ¥ Â· 10ë¶„ ë™ì•ˆ 1íšŒë§Œ ì „ì†¡ ê°€ëŠ¥</div>

    <button id="actionBtn" class="btn btnPrimary" disabled>í™•ì¸ ì¤‘...</button>
  </div>

  <!-- ë©”ì‹œì§€ ì‘ì„± ì˜ì—­ (ì˜¤í”ˆ í›„ í‘œì‹œ / ì „ì†¡ í›„ ìˆ¨ê¹€) -->
  <div id="composerCard" class="card hidden">
    <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:10px">
      <div>
        <div class="title" style="font-size:18px;margin:0;">ë©”ì‹œì§€ ë³´ë‚´ê¸°</div>
        <div class="muted" style="margin-top:6px;">
          ë‹‰ë„¤ì„ ì„ íƒ í›„ <b>200ì ì´ë‚´</b>ë¡œ ì‘ì„±í•˜ì„¸ìš”.<br/>
          <span style="opacity:.9;">(ë©”ì‹œì§€ ë‚´ìš©ì€ í˜„ì¬ ê´€ë¦¬ìë§Œ í™•ì¸)</span>
        </div>
      </div>
      <div class="miniPill">1íšŒ ì œí•œ</div>
    </div>

    <div class="lockHint">
      <div class="muted">
        âœ… <b>2ë¶€ë§Œì˜ íŠ¹ìˆ˜ ê¸°ëŠ¥</b>ì´ì—ìš”.<br/>
        ì‹œê°„ ëë‚˜ë©´ ìë™ ì ê¸ˆë¼ìš”.
      </div>
    </div>

    <select id="toSelect">
      <option value="">ë°›ëŠ” ì‚¬ëŒ ì„ íƒ</option>
    </select>

    <!-- âœ… textarea ì†ì„± ê¹¨ì ¸ìˆë˜ ë¶€ë¶„ ìˆ˜ì • -->
    <textarea id="text" maxlength="200" placeholder="ì§€ê¸ˆ ì´ ìˆœê°„ë§Œì˜ í•œë§ˆë””ë¥¼ ë‚¨ê²¨ì¤˜ (200ì ì´ë‚´)"></textarea>

    <div class="counterRow">
      <div class="muted">ì •ì„±ì€ ì§§ì•„ë„ í‹° ë‚˜ìš”.</div>
      <div class="miniPill"><span id="count">0</span>/200</div>
    </div>

    <button id="sendBtn" class="btn btnPrimary">ì „ì†¡</button>
  </div>

  <div class="row">
    <button class="btn btnGhost" onclick="location.href='/match/'">ë§¤ì¹­ í™•ì¸</button>
    <button class="btn btnGhost" onclick="location.href='/lobby/'">ë¡œë¹„</button>
  </div>

</div>

<form style="display:none;">{% csrf_token %}</form>

<!-- Fullscreen FX -->
<div id="fx" class="fx" onclick="closeFxIfBackdrop(event)">
  <div class="fxPanel">
    <h1 class="fxTitle" id="fxTitle">2ë¶€ ê¸°ëŠ¥</h1>
    <div class="fxSub" id="fxSub">ì˜¤í”ˆ</div>
    <div class="fxName" id="fxName"></div>
    <button class="fxBtn" onclick="closeFx()">í™•ì¸</button>
  </div>
</div>

<script>
async function fetchWithTimeout(url, opts={}, ms=4000){
  const ctrl = new AbortController();
  const t = setTimeout(()=> ctrl.abort(), ms);
  try{ return await fetch(url, { ...opts, signal: ctrl.signal }); }
  finally{ clearTimeout(t); }
}

function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
  return "";
}

let messageOpen = false;
let messageLocked = false;
let messageSent = false;
let timerInterval = null;

const CLIENT_TIMER_KEY = "onelight_message_end_at";
const CLIENT_LOCK_KEY  = "onelight_message_locked"; // âœ… ì‹œê°„ì¢…ë£Œ ìƒíƒœ ì €ì¥

function fmtRemain(sec){
  sec = Math.max(0, Math.floor(sec));
  const m = String(Math.floor(sec/60)).padStart(2,"0");
  const s = String(sec%60).padStart(2,"0");
  return `${m}:${s}`;
}

/* ===== FX ===== */
function closeFxIfBackdrop(e){ if(e.target.id === "fx") closeFx(); }
function closeFx(){ document.getElementById("fx").classList.remove("show"); }
function burstConfetti(){
  const fx = document.getElementById("fx");
  const colors = ["#c714c7","#ff6ad5","#ffffff","#8a2be2","#ff4fd8"];
  for(let i=0;i<46;i++){
    const el = document.createElement("div");
    el.className = "confetti";
    el.style.left = Math.random()*100 + "vw";
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.animationDuration = (1.2 + Math.random()*0.9) + "s";
    el.style.width = (6 + Math.random()*10) + "px";
    el.style.height = (8 + Math.random()*16) + "px";
    el.style.opacity = (0.55 + Math.random()*0.45);
    fx.appendChild(el);
    setTimeout(()=> el.remove(), 2200);
  }
}
function showFx({title, sub, name}){
  document.getElementById("fxTitle").innerText = title || "2ë¶€ ê¸°ëŠ¥";
  document.getElementById("fxSub").innerText = sub || "";
  document.getElementById("fxName").innerText = name || "";
  const fx = document.getElementById("fx");
  fx.classList.add("show");
  burstConfetti();
}

/* ===== UI ===== */
function setUIForClosed(){
  document.getElementById("desc").innerText = "ë©”ì‹œì§€ ê¸°ëŠ¥ì€ 2ë¶€ì—ì„œ ì˜¤í”ˆë©ë‹ˆë‹¤.";
  const btn = document.getElementById("actionBtn");
  btn.innerText = "2ë¶€ì—ëŠ” ì¶”ê°€ê¸°ëŠ¥ì´ ì˜¤í”ˆë©ë‹ˆë‹¤";
  btn.disabled = true;
  document.getElementById("composerCard").classList.add("hidden");
  document.getElementById("badge").classList.add("hidden");
  document.getElementById("timerPill").classList.add("hidden");
  document.getElementById("limitPill").classList.add("hidden");
}

/* âœ… ì‹œê°„ ì¢…ë£Œ UIë¥¼ ë³„ë„ë¡œ ê³ ì • */
function setUIForExpired(){
  document.getElementById("desc").innerHTML = "ğŸ”’ <b>ë©”ì„¸ì§€ ë³´ë‚´ê¸° ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆì–´ìš”.</b><br/>ë‹¤ìŒ ê¸°íšŒë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.";
  const btn = document.getElementById("actionBtn");
  btn.innerText = "ë©”ì„¸ì§€ ë³´ë‚´ê¸° ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆì–´ìš”";
  btn.disabled = true;

  document.getElementById("badge").classList.remove("hidden");
  document.getElementById("timerPill").classList.remove("hidden");
  document.getElementById("limitPill").classList.remove("hidden");
  document.getElementById("remain").innerText = "00:00";

  document.getElementById("composerCard").classList.add("hidden");
}

function setUIForOpen(){
  document.getElementById("desc").innerHTML = "ğŸ’ <b>2ë¶€ ë©”ì‹œì§€ ê¸°ëŠ¥</b>ì´ ì˜¤í”ˆë˜ì—ˆìŠµë‹ˆë‹¤. <br/>10ë¶„ ë™ì•ˆ <b>1íšŒ</b>ë§Œ ë³´ë‚¼ ìˆ˜ ìˆì–´ìš”.";
  document.getElementById("badge").classList.remove("hidden");
  document.getElementById("timerPill").classList.remove("hidden");
  document.getElementById("limitPill").classList.remove("hidden");

  const btn = document.getElementById("actionBtn");

  if(messageLocked){
    setUIForExpired();
    return;
  }
  if(messageSent){
    btn.innerText = "ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ";
    btn.disabled = true;
    document.getElementById("composerCard").classList.add("hidden");
    return;
  }

  btn.innerText = "ë©”ì„¸ì§€ ë³´ë‚´ê¸°";
  btn.disabled = false;
  btn.onclick = () => {
    document.getElementById("composerCard").classList.remove("hidden");
    document.getElementById("composerCard").scrollIntoView({behavior:"smooth"});
  };
}

/* ===== DATA ===== */
async function loadMessageCount(){
  const res = await fetchWithTimeout("/api/message-count/");
  if(res.ok){
    const d = await res.json();
    document.getElementById("msgCount").innerText = d.count ?? 0;
  }
}

async function loadEventState(){
  try{
    const res = await fetchWithTimeout("/api/event-state/");
    if(!res.ok) return {message_open:false};
    return await res.json();
  }catch(e){
    return {message_open:false};
  }
}

async function loadCards(){
  const res = await fetchWithTimeout("/api/cards/");
  if(!res.ok) return [];
  const d = await res.json();
  return d.cards || [];
}

async function hydrateRecipients(){
  const sel = document.getElementById("toSelect");
  sel.innerHTML = `<option value="">ë°›ëŠ” ì‚¬ëŒ ì„ íƒ</option>`;
  try{
    const cards = await loadCards();
    for(const c of cards){
      const opt = document.createElement("option");
      opt.value = c.id;
      opt.textContent = c.nickname;
      sel.appendChild(opt);
    }
  }catch(e){}
}

function applyLimitFromState(state){
  const sent = (typeof state.sent_msg_count === "number") ? state.sent_msg_count : 0;
  document.getElementById("sentMsg").innerText = sent;
  messageSent = sent >= 1;
}

function getOrCreateClientEndAt(){
  let endAt = Number(localStorage.getItem(CLIENT_TIMER_KEY) || "0");
  const now = Date.now();
  if(!endAt || endAt < now){
    endAt = now + 10 * 60 * 1000; // 10ë¶„
    localStorage.setItem(CLIENT_TIMER_KEY, String(endAt));
  }
  return endAt;
}

function markLocked(){
  messageLocked = true;
  localStorage.setItem(CLIENT_LOCK_KEY, "1"); // âœ… ì ê¸ˆ ìƒíƒœ ì €ì¥
}

function isLockedPersisted(){
  return localStorage.getItem(CLIENT_LOCK_KEY) === "1";
}

/* âœ… ì ê¸ˆ ìš°ì„  ì²˜ë¦¬ */
function syncLockFromNow(state){
  // ì„œë²„ê°€ ì ê¹€ì„ ì£¼ë©´ ê·¸ëŒ€ë¡œ
  if(state && state.message_locked === true){
    markLocked();
    return;
  }

  // ë¡œì»¬ì— ì ê¹€ì´ ì´ë¯¸ ì €ì¥ë¼ ìˆìœ¼ë©´ ë
  if(isLockedPersisted()){
    messageLocked = true;
    return;
  }

  // ë‚¨ì€ì‹œê°„ ê³„ì‚°í•´ì„œ ì´ë¯¸ ì§€ë‚¬ìœ¼ë©´ ì ê¸ˆ
  let endAtMs = null;
  if(state && state.message_ends_at){
    endAtMs = new Date(state.message_ends_at).getTime();
  }else{
    endAtMs = getOrCreateClientEndAt();
  }
  if(Date.now() >= endAtMs){
    markLocked();
  }
}

function startTimer(state){
  // ì ê²¨ìˆìœ¼ë©´ 00:00 ê³ ì •
  if(messageLocked){
    document.getElementById("remain").innerText = "00:00";
    return;
  }

  let remain = null;
  if(typeof state.remaining_seconds === "number"){
    remain = state.remaining_seconds;
  } else if(state.message_ends_at){
    const end = new Date(state.message_ends_at).getTime();
    remain = Math.max(0, Math.floor((end - Date.now())/1000));
  } else {
    const endAt = getOrCreateClientEndAt();
    remain = Math.max(0, Math.floor((endAt - Date.now())/1000));
  }

  if(timerInterval) clearInterval(timerInterval);
  document.getElementById("remain").innerText = fmtRemain(remain);

  timerInterval = setInterval(()=>{
    remain -= 1;
    document.getElementById("remain").innerText = fmtRemain(remain);

    if(remain <= 0){
      clearInterval(timerInterval);
      markLocked();
      setUIForExpired();
      showFx({title:"TIME OVER", sub:"ë©”ì„¸ì§€ ë³´ë‚´ê¸° ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆì–´ìš”", name:"ë‹¤ìŒ ê¸°íšŒë¥¼ ë…¸ë ¤ë´ ğŸ”’"});
    }
  }, 1000);
}

/* ===== BOOT ===== */
async function boot(){
  await loadMessageCount();
  const state = await loadEventState();

  messageOpen = !!state.message_open;

  // âœ… ì ê¸ˆ ìƒíƒœë¥¼ ë¨¼ì € í™•ì •(ì´ê²Œ í•µì‹¬)
  syncLockFromNow(state);
  applyLimitFromState(state);

  // âœ… ì‹œê°„ì´ ëë‚¬ìœ¼ë©´ message_openì´ ë­ë“  ë¬´ì¡°ê±´ expired UI
  if(messageLocked){
    setUIForExpired();
    return;
  }

  if(!messageOpen){
    setUIForClosed();
    return;
  }

  setUIForOpen();
  hydrateRecipients();
  startTimer(state);

  const fxKey = "onelight_message_fx_shown";
  if(!localStorage.getItem(fxKey)){
    showFx({title:"2ë¶€ ê¸°ëŠ¥ OPEN", sub:"10ë¶„ ë™ì•ˆ 1íšŒë§Œ", name:"ì§€ê¸ˆë§Œ ê°€ëŠ¥í•œ ë©”ì‹œì§€ âœ¨"});
    localStorage.setItem(fxKey, "1");
  }
}

document.getElementById("text").addEventListener("input", (e)=>{
  document.getElementById("count").innerText = e.target.value.length;
});

document.getElementById("sendBtn").onclick = async ()=>{
  if(!messageOpen){ alert("ì•„ì§ 2ë¶€ ì˜¤í”ˆ ì „ì…ë‹ˆë‹¤."); return; }
  if(messageLocked || isLockedPersisted()){ setUIForExpired(); return; }
  if(messageSent){ alert("ë©”ì‹œì§€ëŠ” 1íšŒë§Œ ë³´ë‚¼ ìˆ˜ ìˆì–´ìš”."); return; }

  const to_id = document.getElementById("toSelect").value;
  const text = document.getElementById("text").value.trim();

  if(!to_id){ alert("ë°›ëŠ” ì‚¬ëŒì„ ì„ íƒí•´ì¤˜"); return; }
  if(!text){ alert("ë‚´ìš©ì„ ì…ë ¥í•´ì¤˜"); return; }
  if(text.length > 200){ alert("200ì ì´ë‚´ë¡œ ì‘ì„±í•´ì¤˜"); return; }

  const csrftoken = getCookie("csrftoken");

  const res = await fetchWithTimeout("/api/message/", {
    method: "POST",
    credentials: "same-origin",
    headers: {"Content-Type":"application/json","X-CSRFToken": csrftoken},
    body: JSON.stringify({to_id, text})
  }, 7000);

  const data = await res.json().catch(()=> ({}));
  if(!res.ok){
    alert(data.error || "ì „ì†¡ ì‹¤íŒ¨");
    return;
  }

  messageSent = true;
  document.getElementById("composerCard").classList.add("hidden");
  document.getElementById("actionBtn").innerText = "ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ";
  document.getElementById("actionBtn").disabled = true;
  document.getElementById("sentMsg").innerText = "1";

  showFx({title:"SENT âœ¨", sub:"ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ", name:"ê´€ë¦¬ì í™•ì¸ í›„ ê³µê°œë  ìˆ˜ ìˆì–´ìš”"});

  document.getElementById("text").value = "";
  document.getElementById("count").innerText = "0";
};

boot().catch((e)=>{
  console.error(e);
  document.getElementById("desc").innerText = "ìƒíƒœë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆì–´ìš”. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.";
  const btn = document.getElementById("actionBtn");
  btn.innerText = "ìƒˆë¡œê³ ì¹¨";
  btn.disabled = false;
  btn.onclick = ()=> location.reload();
});
</script>

</body>
</html>

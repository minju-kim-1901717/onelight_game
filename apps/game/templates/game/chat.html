<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>확인</title>
  <style>
    body{font-family:system-ui;margin:0;padding:24px;background:#0b0b0f;color:#fff}
    .wrap{max-width:560px;margin:0 auto;display:flex;flex-direction:column;gap:14px}
    .card{background:#141420;border-radius:18px;padding:16px}
    .title{font-weight:900;margin-bottom:6px}
    .muted{opacity:.7;font-size:13px;line-height:1.4}

    .btn{width:100%;padding:14px;border-radius:14px;border:0;font-weight:900;background:#2a2a3a;color:#fff;cursor:pointer}
    .btnPrimary{background:#c714c7}
    .btn:disabled{opacity:.55;cursor:not-allowed}
  </style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="title">확인</div>
    <div class="muted">원하는 메뉴를 선택하세요.</div>
  </div>

  <button class="btn btnPrimary" onclick="location.href='/match/'">매칭 확인</button>
  <button id="msgBtn" class="btn" disabled>확인 중...</button>

  <button class="btn" onclick="location.href='/lobby/'">로비</button>
</div>

<form style="display:none;">{% csrf_token %}</form>

<script>
async function loadEventState(){
  const res = await fetch("/api/event-state/");
  if(!res.ok) return {message_open:false};
  return await res.json();
}

async function boot(){
  const state = await loadEventState();
  const btn = document.getElementById("msgBtn");

  if(!state.message_open){
    btn.innerText = "2부에는 추가기능이 오픈됩니다";
    btn.disabled = true;
  } else {
    btn.innerText = "메세지 보내기";
    btn.disabled = false;
    btn.onclick = () => location.href="/message/";
  }
}
boot();
</script>
</body>
</html>
